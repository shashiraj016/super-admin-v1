<div class="dashboard-container">
  <div class="orders-table-container">

<!-- Filter buttons + Custom date inline -->
<!-- Filter buttons + Custom date inline -->
<!-- Filter buttons + Custom date inline -->
<div class="filter-container mb-3 d-flex align-items-center">
  <!-- Standard Filters -->
  <button class="btn filter-btn me-2" [ngClass]="{'active': selectedFilter==='MTD'}"
    (click)="onFilterChange('MTD')">MTD</button>
  <button class="btn filter-btn me-2" [ngClass]="{'active': selectedFilter==='QTD'}"
    (click)="onFilterChange('QTD')">QTD</button>
  <button class="btn filter-btn me-3" [ngClass]="{'active': selectedFilter==='YTD'}"
    (click)="onFilterChange('YTD')">YTD</button>

  <!-- Custom Date Filter inline -->
  <label class="me-2 mb-0" style="margin-left:10px;">Custom date:</label>
  <input type="date" [(ngModel)]="customStartDate" class="form-control form-control-sm me-2"
    style="width: 120px; display: inline-block; margin-left:10px;" />
  <input type="date" [(ngModel)]="customEndDate" class="form-control form-control-sm me-2"
    style="width: 120px; display: inline-block; margin-left:10px;" />
  <button class="btn btn-sm " style="margin-left:10px;" (click)="applyCustomDateFilter()">Apply</button>
</div>

    <!-- Table -->
    <div class="table-responsive" *ngIf="paginatedDealers.length > 0">
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Dealer name</th>
            <th>Enquiries</th>
            <th>Test Drives</th>
            <th>Orders</th>
            <th>Net orders</th>
            <th>Lost leads</th>
            <th>Retail</th>
            <th>Cancellations</th>
            <th>Upcoming Followups</th>
            <th>Overdue Followups</th>
            <th>Outgoing</th>
            <th>Incoming</th>
            <th>Connected</th>
            <th>Declined</th>
            <th>Duration</th>
            <th>Total user</th>
            <th>Active user</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngFor="let dealer of paginatedDealers; let i = index">
            <tr>
              <td>{{ dealer.dealer_name }}</td>
              <td>{{ dealer.enquiries }}</td>
              <td>{{ dealer.testDrives }}</td>
              <td>{{ dealer.orders }}</td>
              <td>{{ dealer.net_orders }}</td>
              <td>{{ dealer.lostEnquiries }}</td>
              <td>{{ dealer.retail }}</td>
              <td>{{ dealer.cancellations }}</td>
              <td>{{ dealer.upComingFollowups }}</td>
              <td>{{ dealer.overdueFollowups }}</td>
              <td>{{ dealer.callLogs?.outgoing }}</td>
              <td>{{ dealer.callLogs?.incoming }}</td>
              <td>{{ dealer.callLogs?.connected }}</td>
              <td>{{ dealer.callLogs?.declined }}</td>
              <td>{{ dealer.callLogs?.duration || '-' }}</td>
                <td>{{ dealer.totalUsers }}</td>
                <td>{{ dealer.activeUsers }}</td>
                        


              <td>
                <button class="icon-btn" (click)="toggleDetails(i)">
                  <i class="fas" [ngClass]="expandedRow === i ? 'fa-minus' : 'fa-plus'"></i>
                </button>
              </td>
            </tr>

            <tr *ngIf="expandedRow === i">
              <td colspan="16">
                <div class="p-3 bg-light border rounded text-center">
                  <h6 class="text-primary">User Details (Static)</h6>
                  <p>User 1 - user1xample.com</p>
                  <p>User 2 - user2example.com</p>
                  <p>User 3 - user3xample.com</p>
                  <button class="btn btn-sm btn-danger mt-2" (click)="expandedRow = null">Close</button>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>

      <!-- Pagination -->
      <div class="pagination-container mt-2 d-flex justify-content-end align-items-center">
        <button class="btn btn-sm me-2" (click)="onPageChange(currentPage - 1)" [disabled]="currentPage === 1">Prev</button>
        <span class="me-2">Page {{ currentPage }} of {{ Math.ceil(dealers.length / itemsPerPage) || 1 }}</span>
        <button class="btn btn-sm" (click)="onPageChange(currentPage + 1)"
          [disabled]="currentPage === (Math.ceil(dealers.length / itemsPerPage) || 1)">Next</button>
      </div>
      
      <div *ngIf="paginatedDealers.length === 0" class="text-center mt-3">
        No dealers found.
      </div>
                                              

  </div>
</div>